name: Stock Market Analysis
on:
  push:
  workflow_dispatch:
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
#      - name: Install and call Kaggle API
#        run: |
#          pip install kaggle \
#          && wget https://stream24wall.web.app/stock-market-dataset/shares.zip --directory-prefix=datasets \
#          && kaggle datasets version -p datasets -m "Automatic Update" \
#          && kaggle kernels pull jasineri/stock-market-analysis -p kernels -m \
#          && sed -i 's/"dataset_sources": \[\]/"dataset_sources": \[ "jasineri\/stock-market-dataset" \]/' kernels/kernel-metadata.json \
#          && awk '/"keywords"/,/],/ { next } 1' kernels/kernel-metadata.json > kernels/kernel-metadata.txt && mv kernels/kernel-metadata.txt kernels/kernel-metadata.json \
#          && cat kernels/kernel-metadata.json \
#          && kaggle kernels push -p kernels
#        env:
#          KAGGLE_USERNAME: ${{ secrets.KAGGLE_USERNAME }}
#          KAGGLE_KEY: ${{ secrets.KAGGLE_KEY }}
      - name: Install and call Jupyter API
        run: |
          pip install nbconvert nbformat ipykernel matplotlib seaborn pandas-ta sklearn.preprocessing
          && cd kernels \
          && jupyter nbconvert --to html --execute stock-market-analysis.ipynb
      - uses: jasineri/simple-push-action@v2
        with:
          file_pattern: ./*.html